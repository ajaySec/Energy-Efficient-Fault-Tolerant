import java.awt.Color;
import java.awt.Container;
import java.awt.Font;
import java.awt.Menu;
import java.awt.MenuBar;
import java.awt.MenuItem;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.DataInputStream;
import java.io.DataOutputStream;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.io.PrintStream;
import java.net.ServerSocket;
import java.net.Socket;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.ResultSetMetaData;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.Vector;

import javax.swing.BorderFactory;
import javax.swing.ImageIcon;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.Timer;
import javax.swing.border.Border;

public class CloudServer implements ActionListener {
	JFrame jf;
	Container c;
	JLabel l1, l2, l3, l4, l5, l6, l7, l8, l9, l10, l11, l12;
	JPanel p1, p2;
	JButton b1, b2, b3, b4;
	JScrollPane sp;
	JTextArea ta;
	JTextField t1;
	MenuBar mbr;
	Menu file;
	MenuItem item1, item2, item3, users;
	Border b11, b22, b33;
	JScrollPane pane;
	String Scheme1, rank;
	String f1 = "", f2 = "", f3 = "", f4 = "", f5 = "", f6 = "", f7 = "",f8 = "";
	int count = 0;
	Timer timer;
	public Font f = new Font("Times new roman", Font.BOLD, 18);

	JLabel mg1, mg2, mg3, mg4, mg5, mg6, mg7, mg8, mg9, mg10, g11, g22, g33,
			g44, g55, g66, g77;
	ImageIcon g1, g2, g3, g4, g5, g6, g7;
	String keyWord = "ef50a0ef2c3e3a5fdf803ae9752c8c66";

	CloudServer() {
		jf = new JFrame(
				"Cloud Server::");
		c = jf.getContentPane();
		c.setLayout(null);
		
		c.setBackground(Color.WHITE);
		timer = new Timer(0, null);

		

		ImageIcon banner = new ImageIcon(this.getClass().getResource("images/server.png"));
		JLabel title = new JLabel();
		title.setIcon(banner);
		title.setBounds(0, 0,  770,590);

		t1 = new JTextField(15);
		Border b22 = BorderFactory.createBevelBorder(0);
		l2 = new JLabel();
		l2.setBorder(b22);
		
		b1 = new JButton("View Owner Files");
		b1.setForeground(Color.BLACK);
		b1.addActionListener(this);

		mbr = new MenuBar();
		file = new Menu("File");
		item2 = new MenuItem("test1");
		users = new MenuItem("test2");

		file.add(item2);
		file.add(users);

		mbr.add(file);
		jf.setMenuBar(mbr);

		c.add(l2);

		c.add(title);
		b1.setBounds(250, 500, 200, 30);
		c.add(b1);
		jf.setBounds(0, 0, 770,650);
		jf.show();

		int[] ports = new int[] { 2424};
		for (int i = 0; i < 1; i++) {
			Thread t2 = new Thread(new PortListener(ports[i]));
			t2.start();
		}
	}

	public void actionPerformed(ActionEvent e) {
		Object o = e.getSource();
				
		if (o == b1) {
			
			try{
			Vector heading = new Vector();
			
			heading.addElement("Owner Name");
			heading.addElement("File Name");
			heading.addElement("Secret Key");
		
			Vector data = new Vector();

			String query = "SELECT * FROM cloudfiles";

			
			Dbcon con=new Dbcon();
			
			ResultSet rs =con.getConnection().createStatement().executeQuery(query);
			

			ResultSetMetaData rsm = rs.getMetaData();
			int col = rsm.getColumnCount();

			while (rs.next()) {
				Vector row = new Vector();
				for (int i = 1; i <= col; i++) {
					row.addElement(rs.getObject(i));

				}

				data.addElement(row);
			}

			JTable table = new JTable(data, heading);

			JScrollPane pane = new JScrollPane(table);

			pane.setBounds(50,100,650,250);
			c.add(pane);

		} catch (Exceptio